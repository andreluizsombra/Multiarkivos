@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Cadastro de Documento";
}
<style>
    .margin-top25 {
        margin-top: 25px;
    }
</style>
<div class="panel-heading">
    <h4 class="panel-title"><i class="fa fa-file-archive-o"></i>&nbsp;@ViewBag.Title</h4>
</div>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            &nbsp
        </div>
    </div>

    @using (Html.BeginForm("Create", "Perfil", FormMethod.Post, new { @class = "" }))
    {

        if (ViewBag.ListaCliente != null)
        {
            <input type="hidden" id="acao" name="acao" />
            <input type="hidden" id="modulos" name="modulos" />
            <input type="hidden" id="qtdeModulos" name="qtdeModulos" />
            <input type="hidden" id="selecionado" />
            <input type="hidden" id="cliente" name="cliente" />
            <input type="hidden" id="servico" name="servico" />
            <input type="hidden" id="nomeperfil" name="nomeperfil" />

            <input type="hidden" id="idcliente" name="idcliente" value="@ViewBag.idCliente" />
            <input type="hidden" id="idservico" name="idservico" />

            <div class="container-fluid">

                <div class="row">
                    <div class="col-lg-3">
                        <label>Cliente : </label>@Html.DropDownList("SelCliente", new SelectList(ViewBag.ListaCliente, "Value", "Text", ViewBag.idCliente), new { @class = "form-control" })
                    </div>
                    @if (ViewBag.ListaServico != null)
                    {
                        <div class="col-lg-3">
                            <label>Serviço : </label>@Html.DropDownList("SelServico", new SelectList(ViewBag.ListaServico, "Value", "Text", ViewBag.idServico), new { @class = "form-control" })
                        </div>
                    }

                    <div class="col-lg-3">
                        <label>Nome Documento : </label>
                        <input type="text" id="txtnomedoc" name="txtnomedoc" class="form-control">
                    </div>

                    <div class="col-lg-3">

                        <button type="submit" id="btnGravar" class="btn btn-success margin-top25">
                            <span class="fa fa-save" aria-hidden="true"></span>&nbsp;Gravar
                        </button>
                        <!--<div class="btn btn-info" id="btnNovo"><i class="fa fa-plus"></i>&nbsp;Novo</div>
                        <div class="btn btn-success" id="btnAlterar"><i class="fa fa-edit"></i>&nbsp;Alterar</div>
                        <div class="btn btn-danger" id="btnConfExcluir"><i class="fa fa-trash"></i>&nbsp;Excluir</div>-->
                        <a id="btn_voltapesquisa" class="btn btn-warning margin-top25" style="margin-top:25px" href="@Url.Content("~/Manutencao/DocumentoModelo")"><i class="glyphicon glyphicon-arrow-left"></i>&nbsp;Voltar</a>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        &nbsp
                    </div>
                </div>
            </div>
    @*<p>
        <div class="btn btn-success" id="btnSelecionados">Teste</div>
    </p>*@
            if (ViewBag.ListaCampos != null)
            {
                <div class="container-fluid">
                    <hr />
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="table-responsive">
                                <table id="tblCampos" class="table table-striped table-hover">
                                    <thead>
                                        <tr linha=titulo>
                                            <th><i class="fa fa-list"></i>&nbsp;Campos</th>
                                            <th>&nbsp;</th>
                                            <th>Enviar</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbcampos">
                                        @foreach (var cmp in ViewBag.ListaCampos)
                                        {
                                            <tr id="cmp_@cmp.idCampoModelo" codigo="@cmp.idCampoModelo">
                                                <td>@cmp.Rotulo</td>
                                                <td>@cmp.RotuloAbreviado</td>
                                                <td><a href="#" onclick="Enviar('@cmp.idCampoModelo')"><i class="fa fa-arrow-right"></i></a></td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                                <div id="tabela"></div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="table-responsive">
                                <table id="tblCamposSelecionados" class="table table-striped table-hover">
                                    <thead>
                                        <tr linha=titulo>
                                            <th><i class="fa fa-list"></i>&nbsp;Campos Selecionados</th>
                                            <th>&nbsp;</th>
                                            <th>Retornar</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbselecionado">
                                       
                                    </tbody>
                                </table>
                                <div id="tabela"></div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            &nbsp
                        </div>
                    </div>
                </div>
            }

        }
    }


</div>
<script>
    $().ready(function () {

        $('#pnlHeader').hide();
        $("#SelCliente").change(function () {
            $("#selecionado").val($("#SelCliente").val());
            $("#cliente").val($("#SelCliente option:selected").text());
            var url = "/Manutencao/DocumentoModelo/ListaServico?idCliente=" + $("#selecionado").val();
            window.location.href = url;
        });

        $("#SelServico").change(function () {
            $("#cliente").val($("#SelCliente option:selected").text());
            $("#servico").val($("#SelServico option:selected").text());

            var url = "/Manutencao/DocumentoModelo/ListarCampos?idCliente=" + $("#SelCliente").val() + "&idServico=" + $("#SelServico").val();
            window.location.href = url;
        });

        console.log($("#idcliente").val());
        //$("#SelCliente").val($("#idcliente").val());
        // var id_servico = $("#SelServico").val();
        // $("#SelServico").val(id_servico);
        $("#btnGravar").click(function () {
            if ($("#SelServico option:selected").text() == 'Selecione') {
                exibirmsgatencao('Por favor selecione um serviço...');
                return false;
            }
            if ($("#txtnomedoc").val() == "") {
                exibirmsgatencao('Por favor preencher campo nome documento...');
                return false;
            }
        });

        $("#btnSelecionados").click(function () {
            $("#tbselecionado>tr").each(function () {
                console.log($("#"+this.id).attr('codigo'));
            });
        });

    });

    function Enviar(sel) {
        $("#cmp_" + sel).appendTo("#tbselecionado");
        $("#cmp_" + sel + ">td>a").attr('onclick', "Retorna('" + sel + "')");
        $("#cmp_" + sel + ">td>a>i").attr('class', 'fa fa-arrow-left');
    }
    function Retorna(sel) {
        $("#cmp_" + sel).appendTo("#tbcampos");
        $("#cmp_" + sel + ">td>a").attr('onclick', "Enviar('" + sel + "')");
        $("#cmp_" + sel + ">td>a>i").attr('class', 'fa fa-arrow-right');
    }
</script>

